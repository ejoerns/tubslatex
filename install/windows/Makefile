# Makefile (c) 2011 by Enrico JÃ¶rns
# ---------------------------------
#
# Benutzung:
#   Aufrunf von 'make' erzeugt exe-Datei ...

include ../../Makefile.include

VERSION = $(TUBSLATEX_FULLVERSION)


.PHONY: exe build structure fetch clean install

all: build copy exe

copy: clean structure fetch

exe:
	$(ECHO) -n 'Compiling Windows-Installer...'
	$(CAT) tubslatexSetup_script.nsi | sed 's/REPLACEWITHVERSION/$(VERSION)/g' > tmp.nsi
	$(MAKENSIS) tmp.nsi $(SILENT)
	$(RM) tmp.nsi
	$(ECHO) -e '$(DONE_STRING)'

build:
	$(MAKE) -C $(INSTALL_RAW_DIR)

structure:
	$(MKDIR) -p data

fetch:
	$(CP) -r $(INSTALL_RAW_DIR)/tex data/.
	$(CP) -r $(INSTALL_RAW_DIR)/doc data/.
	$(CP) -r $(INSTALL_RAW_DIR)/fonts data/.

clean:
	$(RM) -rf data

install:
	$(WINE) tubslatexSetup_$(VERSION).exe
