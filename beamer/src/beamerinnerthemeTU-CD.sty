\ProvidesPackage{beamerinnerthemeTU-CD}[2010/03/09  v0.2.1 TU-Braunschweig-CD]
\RequirePackage{ifthen}
\RequirePackage{relsize}[1999/11/01]
\newboolean{useminion}

\RequirePackage{printlen}

\DeclareOptionBeamer{shadow}[true]{\def\beamer@themerounded@shadow{#1}}
\ExecuteOptionsBeamer{shadow=false}
\DeclareOptionBeamer{minion}{\setboolean{useminion}{true}}
\ProcessOptionsBeamer

% loads the default title graphic
\newcommand{\tuDefaultTitlegraphic}{%
\includegraphics[width=\titlegraphicswidth]{defaulttitlepicture}}


\mode<presentation>
\ifthenelse{\boolean{useminion}}{%
  \usepackage{MinionPro}%
  \usefonttheme{serif}
}{%
  %% Change here for different maths font, if desired
  \usepackage{eulervm}
  \usepackage{uarial}%
}


\setbeamertemplate{blocks}[rounded][shadow=\beamer@themerounded@shadow]

%% Trick: To re-define a template from scratch, give it a new name as
%% second argument.

\defbeamertemplate*{title page}{TU-CD}[1][]
{%
  \vspace*{-0.5em} % korrigierte Nulllinie
  \vspace*{\beamer@CDsenderheight}
  \begin{beamercolorbox}[
      wd=\beamer@CDcommunicationwidth,
      ht=11\beamer@CDgaussunit]
      {titlebarthird}
    \usebeamerfont{title}\centering\inserttitlegraphic%
  \end{beamercolorbox}%
  \vskip-0.1em

  \begin{beamercolorbox}[wd=\beamer@CDcommunicationwidth,
      ht=9\beamer@CDgaussunit]
      {titlebarsecond}
    \vskip0.8em\par
    \hspace*{\beamer@leftmarginwidth}
    \usebeamerfont{title}\inserttitle \par%
    \vskip0.4em\par
    \hspace*{\beamer@leftmarginwidth}
    \usebeamerfont{subtitle}\insertsubtitle \par%
    \vskip0.8em\par
    \hspace*{\beamer@leftmarginwidth}
    \usebeamerfont{author}\insertauthor, \insertdate
    \vskip1.5em\par
  \end{beamercolorbox}%
  \vskip-0.1em
  {\tiny
  \begin{beamercolorbox}[wd=\beamer@CDcommunicationwidth,
      ht=\beamer@CDgaussunit]
      {titlebarlow}
  \end{beamercolorbox}}%
  \vspace*{-24.1\beamer@CDgaussunit}

  \begin{beamercolorbox}[wd=\beamer@CDcommunicationwidth,
      ht=4\beamer@CDgaussunit]
      {structure}
    \hspace*{-\beamer@CDborderwidth}\tulogoAbs{37mm}
  \end{beamercolorbox}
  \vspace*{-20mm}

  \begin{beamercolorbox}[
      wd=\beamer@CDcommunicationwidth,ht=4\beamer@CDgaussunit]
      {structure}
    \flushright\insertlogo
  \end{beamercolorbox}
  \vspace*{22.3\beamer@CDgaussunit}
}

\defbeamertemplate*{part page}{TU-CD}[1][]
{%
  \tableofcontents[currentsection,currentsubsection]
}

%% Itemize environment with narrower lines
\newenvironment{narrowitemize}{%
  \begin{itemize}\setlength{\itemsep}{0pt}}{\end{itemize}}
%% Itemize environment with narrower lines and with no item signs
\newenvironment{emptyitemize}{%
\setbeamertemplate{itemize item}{\ }
\setbeamertemplate{itemize subitem}{\rule[0.17em]{0.25em}{0.25em}}
\begin{itemize}\setlength{\itemsep}{0pt}}{\end{itemize}}

%  Squares for items
\defbeamertemplate*{itemize item}{TU-CD}{\rule[0.15em]{0.3em}{0.3em}}
\defbeamertemplate*{itemize subitem}{TU-CD}{\rule[0.17em]{0.25em}{0.25em}}
%  dash for subsubitems
\defbeamertemplate*{itemize subsubitem}{TU-CD}{\textbf{\textendash}}
\defbeamertemplate*{itemize subsubsubitem}{TU-CD}{\textperiodcentered}

\defbeamertemplate{section in toc}{TU-CD}{%
  \leavevmode\normalsize\raise-1.5pt\hbox{\rule[0.15em]{0.3em}{0.3em}}\kern1.25ex
  \inserttocsection\par
}
\defbeamertemplate{subsection in toc}{TU-CD}{%
  \leavevmode\leftskip=1.5em\hbox{\rule[0.17em]{0.25em}{0.25em}}%
  \kern1ex\inserttocsubsection\par
}
\defbeamertemplate{subsubsection in toc}{TU-CD}{%
  \leavevmode\normalsize\usebeamerfont{subsection in
    toc}\leftskip=3em\usebeamerfont{subsubsection in toc}%
  \hbox{\textasteriskcentered}%
  \kern0.75ex\inserttocsubsubsection\par
}

\setbeamertemplate{items}[TU-CD]
\setbeamertemplate{sections/subsections in toc}[TU-CD]

\setlength{\leftmargini}{1.3em}
\setlength{\leftmarginii}{1.3em}
\setlength{\leftmarginiii}{1.3em}
\setlength{\leftmarginiv}{1.3em}

\setbeamercovered{transparent}

\mode<all>


%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% TODO: Entfernen????

\newboolean{usethis}
\setboolean{usethis}{false}
\ifthenelse{\boolean{usethis}}{%
\DeclareRobustCommand\noscshape{%
  \not@math@alphabet\noscshape\relax
  \ifthenelse{\equal{\f@shape}{\scdefault}}{%
    \fontshape\updefault
  }{%
  }%
  \selectfont
}
\RequirePackage[sepfour]{numprint}[2003/09/18]
\RequirePackage[activate]{pdfcprot}[2002/02/27]

\DeclareRobustCommand\acro[1]{\textsmaller{\MakeUppercase{#1}}}

\newcommand\person{}%
\let\person=\emph
\newcommand\new{}%
\let\new=\emph
\newcommand\engl{}%
\let\engl=\emph
%\newcommand*\qed{%
%  \hskip 1em plus 1fill\rule{0pt}{1ex}\hskip\z@skip
%  \hglue 0pt plus 1fill\mbox{\qedname}}
\newcommand*\qedname{\rule{1ex}{1ex}}
\newcommand*\tr{\mathop{\operator@font tr}\nolimits}
\newcommand*\e{\mathop{\operator@font e}\nolimits}
\newcommand*\D{\ensuremath{\upDelta}}
\newcommand*\grad{\mathop{\operator@font grad}\nolimits}
\newenvironment{cases*}{%
  \matrix@check\cases\env@cases
}{%
  \endarray\right\rbrace%
}
\newcommand*\equivalent{\ensuremath{\mathrel{\widehat{=}}}}

\newenvironment{nomathindent}[1][1.0]{%
  \addtolength{\mathindent}{-#1\mathindent}%
  \ignorespaces
}{\ignorespacesafterend}

%\ClassWarningNoLine{rhbslides}{The combination of the main font
%  Times\MessageBreak
%  with bold vectors (option <boldvec>)\MessageBreak
%  leads to ugly results in some cases}%
%\renewcommand*\vec[1]{\ensuremath{\pmb{#1}}}
%\renewcommand*\matr[1]{\ensuremath{\pmb{#1}}}
%\renewcommand*\tens[2]{\ensuremath{\pmb{#1}}}

\addto\extrasgerman{\npdecimalsign{,}\npproductsign{\cdot}}%
\addto\extrasngerman{\npdecimalsign{,}\npproductsign{\cdot}}%
\addto\extrasaustrian{\npdecimalsign{,}\npproductsign{\cdot}}%
\addto\extrasnaustrian{\npdecimalsign{,}\npproductsign{\cdot}}%
\addto\extrasenglish{\npdecimalsign{.}\npproductsign{\cdot}}%
\addto\extrasamerican{\npdecimalsign{.}\npproductsign{\times}}%

\mathchardef\mathcomma\mathcode`\,
\mathcode`\,=32768 % "8000
\begingroup
\catcode`\_=12
\catcode`\,=\active
\@firstofone{%
\endgroup
 \edef\DC@char{\meaning_}
 \def\DC@parse#1 _{\def\DC@parse##1#1 ##2##3\delimiter{##2}}
 \expandafter\DC@parse\DC@char
 \toks@={\expandafter\DC@parse\meaning\DC@char}
 \edef\DC@test{9<2\the\toks@ \DC@char.\delimiter}
 \DeclareRobustCommand\ActiveComma{\futurelet\DC@char\DC@docomma}
 \def\DC@docomma{%
   \ifnum\DC@test \mathord \fi
   \mathcomma
 }
 \let,\ActiveComma
}

\let\glqq=\frqq
\let\grqq=\flqq
\let\glq=\frq
\let\grq=\flq
}{}
%%%%%%%%%%%%%%%%%%%%%%%%%%

