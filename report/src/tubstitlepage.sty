\ProvidesPackage{tubstitlepage}

\RequirePackage{xkeyval}
\RequirePackage{tubslayout}
\RequirePackage{tubscolors}

% Allow to choose default style
\def\style@select{plain}
\DeclareOptionX{backstyle}{%
  \def\style@select{#1}
}

\ProcessOptionsX\relax



% This package offers functionality to create titlepages in the
% CorporateDesign of the TU Braunschweig.

\let\oldmaketitle\maketitle

\newcommand{\titlestyle}[1]{%
  \csname tubs@style@bg@#1\endcsname
}

% Redefine maketitle, provide additional optional arguments
\renewcommand{\maketitle}{%
  \expandafter\csname tubs@style@content@\style@select\endcsname
}

% Redefine environment titlepage, provide additional optional arguments
\renewenvironment{titlepage}[1][\relax]{%
}{%
}

% Allows to set a logo
\newcommand{\logo}[1]{%
  
}

% Creates new title style
% produces command of type \tubs@style@bg@stylename
% args:
% 1 - style name
% 2 - background style
% 3 - foreground style
% 4 - content
\newcommand{\new@title@style}[4]{%
  \expandafter\def\csname tubs@style@bg@#1\endcsname{#2}
  \expandafter\def\csname tubs@style@fg@#1\endcsname{#3}
  \expandafter\def\csname tubs@style@content@#1\endcsname{#4}
}

%%% styles defenitions %%%

\new@title@style{plain}{%
  \defbgtemplate[1]{1}{%
    \topline
    \emptyframe{8}
    \placetubslogo{left}
  }
}{}{\oldmaketitle}

\new@title@style{color}{%
  \defbgtemplate[1]{4}{%
    \colorframe{2}{tuSecondary100}
    \colorframe{2}{tuSecondary80}
    \colorframe{1}{tuSecondary60}
    \colorframe{3}{tuSecondary40}
    \placetubslogo{left}
  }
}{%
  \newdynamictubsframe[1]{tubs@title}{3}{2}{1}{6}
  \newdynamictubsframe[1]{tubs@author}{5}{1}{1}{6}
  \newdynamictubsframe[1]{tubs@abstract}{6}{3}{1}{6}
}{%
  \setdynamiccontents*{tubs@title}{%
    \sffamily%
    {\bfseries\Huge\@title}\bigskip\\%
    {\LARGE\@subtitle}%
    \vfill%
    {\Large\@date}}
  \setdynamiccontents*{tubs@author}{%
    \vfill%
    {\sffamily\Huge\@author}%
    \vfill}
  ~\newpage
}

% finally, load selected style
\expandafter\csname tubs@style@bg@\style@select\endcsname
\expandafter\csname tubs@style@fg@\style@select\endcsname
